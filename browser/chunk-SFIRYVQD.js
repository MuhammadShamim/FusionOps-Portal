import{a as ie,b as B,c as U,d as ne,e as oe,f as z,g as re,h as ae,i as j}from"./chunk-DGQRUHHX.js";import{$ as H,Aa as Oe,C as v,D as we,Ea as Ve,F as se,Fa as K,G as d,H as s,I as a,J as b,K as O,L as V,M as S,N as g,O as m,P as Te,Q as Se,R as D,S as Ee,T as u,U as w,V as E,W as P,X as M,Y as I,Z as Pe,a as F,aa as ge,b as q,ba as _e,ca as fe,da as he,e as W,f as ke,h as ue,k as Y,ka as ve,la as X,ma as R,n as Q,na as Z,o as f,oa as ee,p as h,pa as te,qa as be,ra as ye,sa as A,ua as Me,v as l,va as le,x as T,y as N,ya as L,za as Ie}from"./chunk-ALZ7CTEH.js";var Ue=[[["","header-actions",""]],"*"],ze=["[header-actions]","*"],Je=(n,r)=>({"fa-moon":n,"fa-sun":r}),me=()=>({exact:!0});function qe(n,r){n&1&&(s(0,"li")(1,"a",13),b(2,"i",14),u(3," Dashboard "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function He(n,r){n&1&&(s(0,"li")(1,"a",15),b(2,"i",16),u(3," Notes "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function Ge(n,r){n&1&&(s(0,"li")(1,"a",17),b(2,"i",18),u(3," Kanban "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function Ye(n,r){n&1&&(s(0,"li")(1,"a",19),b(2,"i",20),u(3," Carrier Profile "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function Qe(n,r){n&1&&(s(0,"li")(1,"a",21),b(2,"i",22),u(3," Settings "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function Xe(n,r){n&1&&(s(0,"li")(1,"a",23),b(2,"i",24),u(3," PagerDuty "),a()()),n&2&&(l(),d("routerLinkActiveOptions",H(1,me)))}function Ze(n,r){if(n&1){let o=S();s(0,"li")(1,"a",25),g("click",function(t){f(o);let i=m();return t.preventDefault(),h(i.signOut.emit())}),b(2,"i",26),u(3," Sign Out "),a()()}}var $=(()=>{let r=class r{constructor(){this.isAuthenticated=!1,this.signOut=new we,this.year=new Date().getFullYear(),this.isDarkMode=!1}ngOnInit(){this.isDarkMode=document.body.classList.contains("dark-mode")}toggleDarkMode(){this.isDarkMode=!this.isDarkMode,document.body.classList.toggle("dark-mode",this.isDarkMode)}onSignOut(){this.signOut.emit()}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=N({type:r,selectors:[["integrationops-private-layout"]],inputs:{isAuthenticated:"isAuthenticated"},outputs:{signOut:"signOut"},ngContentSelectors:ze,decls:23,vars:12,consts:[[1,"private-layout"],[1,"private-header"],[1,"header-content"],[1,"app-title"],[1,"header-actions"],["type","button","title","Toggle dark mode",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas",3,"ngClass"],[1,"app-body"],[1,"sidebar","integrationops-sidebar"],[1,"nav","nav-pills","flex-column","mb-auto"],[4,"ngIf"],[1,"main-content"],[1,"private-footer"],["routerLink","/app/dashboard","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-tachometer-alt"],["routerLink","/app/notes","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-sticky-note"],["routerLink","/app/kanban","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-columns"],["routerLink","/app/carrier-profile","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-truck"],["routerLink","/app/settings","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-cog"],["routerLink","/app/pagerduty-events","routerLinkActive","active",1,"nav-link","integrationops-nav-link",3,"routerLinkActiveOptions"],[1,"fas","fa-bell"],["href","#",1,"nav-link","integrationops-nav-link",3,"click"],[1,"fas","fa-sign-out-alt"]],template:function(t,i){t&1&&(Te(Ue),s(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3),u(4,"Integration Ops Portal"),a(),s(5,"div",4)(6,"button",5),g("click",function(){return i.toggleDarkMode()}),b(7,"i",6),a(),Se(8),a()()(),s(9,"div",7)(10,"nav",8)(11,"ul",9),v(12,qe,4,2,"li",10)(13,He,4,2,"li",10)(14,Ge,4,2,"li",10)(15,Ye,4,2,"li",10)(16,Qe,4,2,"li",10)(17,Xe,4,2,"li",10)(18,Ze,4,0,"li",10),a()(),s(19,"main",11),Se(20,1),a()(),s(21,"footer",12),u(22),a()()),t&2&&(l(7),d("ngClass",_e(9,Je,!i.isDarkMode,i.isDarkMode)),l(5),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(),d("ngIf",i.isAuthenticated),l(4),E(" \xA9 ",i.year," Integration Ops. All rights reserved. "))},dependencies:[A,ve,R,Ve,Ie,Oe],styles:[".private-layout[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;background:var(--color-bg)}.private-header[_ngcontent-%COMP%]{background:var(--color-card);position:sticky;top:0;left:0;width:100%;z-index:1040;height:64px;display:flex;align-items:center;box-shadow:0 2px 8px #4f8cff1a;border-bottom:1px solid var(--color-border);transition:var(--transition)}.private-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:space-between;gap:1.5rem}.private-header[_ngcontent-%COMP%]   .app-title[_ngcontent-%COMP%]{font-weight:700;font-size:1.5rem;color:var(--color-primary);letter-spacing:.5px}.private-header[_ngcontent-%COMP%]   .universal-search[_ngcontent-%COMP%]{flex:1;max-width:400px;margin:0 2rem}.private-header[_ngcontent-%COMP%]   .universal-search[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;border-radius:8px;border:1px solid var(--color-border);padding:.5rem 1rem;background:var(--color-bg);color:var(--color-text);transition:var(--transition)}.private-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.private-footer[_ngcontent-%COMP%]{background:var(--color-footer-bg);position:sticky;bottom:0;left:0;width:100%;z-index:1040;height:56px;display:flex;align-items:center;justify-content:center;border-top:1px solid var(--color-border);color:var(--color-text);transition:var(--transition)}.app-body[_ngcontent-%COMP%]{flex:1;display:flex;min-height:0;height:100vh}.sidebar[_ngcontent-%COMP%]{min-width:250px;max-width:260px;height:100vh;background:var(--color-card);color:var(--color-sidebar-link-active);border-right:1px solid var(--color-sidebar-border);position:sticky;top:0;left:0;z-index:1020;box-shadow:2px 0 8px #4f8cff14;border-radius:0;padding:2rem 1rem 1rem 1.5rem;display:flex;flex-direction:column;gap:2rem;transition:var(--transition)}.sidebar[_ngcontent-%COMP%]   .sidebar-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:var(--color-primary);margin-bottom:2rem;letter-spacing:.5px;display:flex;align-items:center;gap:.5rem}.sidebar[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}.sidebar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:var(--color-text);font-weight:500;font-size:1rem;border-radius:8px;padding:.75rem 1rem;margin-bottom:.25rem;display:flex;align-items:center;gap:.75rem;transition:background .2s,color .2s}.sidebar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{background:var(--color-primary);color:#fff!important;box-shadow:0 2px 8px #4f8cff1f}.sidebar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.private-layout[_ngcontent-%COMP%]   .workspace[_ngcontent-%COMP%]{flex:1;display:flex;min-height:0;background:var(--color-bg)}.main-content[_ngcontent-%COMP%]{flex:1;padding:2rem;background:var(--color-bg);min-width:0;overflow-y:auto;border-left:1px solid var(--color-border);border-radius:0;color:var(--color-text);transition:var(--transition);height:100vh;display:flex;flex-direction:column}.btn-gradient-primary[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff;border:none;transition:background .2s}.btn-gradient-primary[_ngcontent-%COMP%]:hover{background:var(--color-primary-dark);color:#fff}@media (max-width: 768px){.private-layout[_ngcontent-%COMP%]   .workspace[_ngcontent-%COMP%]{flex-direction:column}.app-body[_ngcontent-%COMP%]{flex-direction:column;height:auto}.sidebar[_ngcontent-%COMP%]{width:100%;max-width:100%;min-width:0;position:static;height:auto;border-right:none;border-bottom:1px solid var(--color-sidebar-border);border-radius:0 0 16px 16px}.main-content[_ngcontent-%COMP%]{border-left:none;border-radius:0;padding:1rem;height:auto}.private-header[_ngcontent-%COMP%]   .universal-search[_ngcontent-%COMP%]{display:none}}"]});let n=r;return n})();var Ce=(()=>{let r=class r{constructor(){this.env={},this.env={API_BASE_URL:"/api",API_CLIENT_ID:"your_client_id_here",API_CLIENT_SECRET:"your_client_secret_here"}}get(e){return this.env[e]}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var Ae=(()=>{let r=class r{constructor(e,t){this.http=e,this.env=t}getStatus(){let e=this.env.get("API_BASE_URL"),t="",i="",c=localStorage.getItem("integrationops_secrets");if(c)try{let C=atob(c),x=JSON.parse(C);t=x.apiId,i=x.secret}catch{}if(!e||!(e==="/api"||e.startsWith("http://")||e.startsWith("https://")))return W({status:"error",message:"API_BASE_URL is missing or not set to a valid URL."});if(!t)return W({status:"error",message:"API_CLIENT_ID is missing or not set in Settings."});if(!i)return W({status:"error",message:"API_CLIENT_SECRET is missing or not set in Settings."});let p=`${e}/statuscheck`,_={client_id:t,client_secret:i};return this.http.get(p,{headers:_}).pipe(ke(C=>C&&(C.success===!0||C.status===200)?{status:"success",message:"API is healthy"}:C&&typeof C.message=="string"?{status:"error",message:C.message}:{status:"error",message:"Unknown error"}),ue(C=>{let x="";return C?.error&&typeof C.error=="string"&&C.error.trim().startsWith("<!DOCTYPE html")?x="Server returned an HTML error page (possible 404 or 500).":C?.error&&typeof C.error=="object"?x=C.error.message||JSON.stringify(C.error):x=C?.message||"API unreachable",W({status:"error",message:x})}))}};r.\u0275fac=function(t){return new(t||r)(Q(le),Q(Ce))},r.\u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var tt=(n,r)=>({"bg-success text-white":n,"bg-warning text-dark":r}),Fe=(()=>{let r=class r{onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}constructor(e,t,i){this.apiStatusService=e,this.authService=t,this.router=i,this.isAuthenticated=!0,this.apiStatus=null}ngOnInit(){this.apiStatusService.getStatus().subscribe(e=>{this.apiStatus=e})}};r.\u0275fac=function(t){return new(t||r)(T(Ae),T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-dashboard"]],decls:17,vars:7,consts:[[3,"signOut","isAuthenticated"],[1,"container-fluid","py-5","px-3","px-md-5"],[1,"row","mb-4"],[1,"col-12","text-center"],[1,"lead","text-muted"],[1,"row","g-4","mb-5"],[1,"col-md-3"],[1,"fusionops-card","border-0","shadow-lg",3,"ngClass"],[1,"card-body"],[1,"card-title","mb-2"],[1,"fas","fa-server","me-2"],[1,"card-text","fs-5","fw-bold","mb-1"],[1,"card-text","mb-0"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0),g("signOut",function(){return i.onSignOut()}),s(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),u(5,"Welcome to your dashboard! Here are your quick stats and links."),a()()(),s(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"h5",9),b(11,"i",10),u(12,"API Status"),a(),s(13,"p",11),u(14),a(),s(15,"p",12),u(16),a()()()()()()()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(8),d("ngClass",_e(4,tt,(i.apiStatus==null?null:i.apiStatus.status)==="success",(i.apiStatus==null?null:i.apiStatus.status)==="error")),l(6),E(" ",(i.apiStatus==null?null:i.apiStatus.status)==="success"?"Healthy":"Error"," "),l(2),E(" ",i.apiStatus==null?null:i.apiStatus.message," "))},dependencies:[A,ve,j,$],styles:[".list-unstyled[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;transition:color .2s}.list-unstyled[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#6366f1}"]});let n=r;return n})();var Re=(()=>{let r=class r{constructor(e,t){this.http=e,this.env=t}getCarrierProfile(e){let t=this.env.get("API_BASE_URL"),i="",c="",p=localStorage.getItem("integrationops_secrets");if(p)try{let x=atob(p),k=JSON.parse(x);i=k.apiId,c=k.secret}catch{}if(!t||!(t==="/api"||t.startsWith("http://")||t.startsWith("https://")))return W({error:{status:"Config",message:"API_BASE_URL is missing or not set to a valid URL."}});if(!i)return W({error:{status:"Config",message:"API_CLIENT_ID is missing or not set in Settings."}});if(!c)return W({error:{status:"Config",message:"API_CLIENT_SECRET is missing or not set in Settings."}});let _=`${t}/carrierprofile/${encodeURIComponent(e)}`,C={client_id:i,client_secret:c};return console.log("[CarrierProfileService] Lookup:",{url:_,headers:C,carrierName:e}),this.http.get(_,{headers:C}).pipe(ue(x=>{let k=x?.status||"Unknown",y="";return x?.error&&typeof x.error=="string"&&x.error.trim().startsWith("<!DOCTYPE html")?y="Server returned an HTML error page (possible 404 or 500).":x?.error&&typeof x.error=="object"?y=x.error.message||JSON.stringify(x.error):y=x?.message||"API unreachable",W({error:{status:k,message:y}})}))}getSecrets(){let e=localStorage.getItem("integrationops_secrets");if(e)try{return atob(e)}catch{return null}return null}};r.\u0275fac=function(t){return new(t||r)(Q(le),Q(Ce))},r.\u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();function nt(n,r){if(n&1&&(s(0,"div",13),u(1),a()),n&2){let o=m();l(),E(" ",o.carrierProfileError," ")}}function ot(n,r){if(n&1&&(s(0,"pre",14)(1,"code"),u(2),a()()),n&2){let o=m();l(2),w(o.profileJson)}}var Le=(()=>{let r=class r{constructor(e,t,i){this.carrierProfileService=e,this.authService=t,this.router=i,this.carrierName="",this.carrierProfile=null,this.carrierProfileError=null}onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}get profileJson(){return this.carrierProfile?JSON.stringify(this.carrierProfile,null,2):""}getCarrierProfile(){this.carrierProfile=null,this.carrierProfileError=null,this.carrierName.trim()&&this.carrierProfileService.getCarrierProfile(this.carrierName.trim()).subscribe(e=>{if(console.log("[CarrierProfileComponent] Response:",e),e&&!e.error)this.carrierProfile=e;else{let t=e?.error?.status||e?.status||"",i=e?.error?.message||e?.error||e?.message||"No profile found or API error.";typeof i=="object"&&(i=JSON.stringify(i)),this.carrierProfileError=(t?`HTTP ${t}: `:"")+i}},e=>{console.log("[CarrierProfileComponent] Error:",e);let t=e?.status||"",i=e?.error?.message||e?.message||e?.error||"API error.";typeof i=="object"&&(i=JSON.stringify(i)),this.carrierProfileError=(t?`HTTP ${t}: `:"")+i})}};r.\u0275fac=function(t){return new(t||r)(T(Re),T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-carrier-profile"]],decls:15,vars:4,consts:[[3,"signOut","isAuthenticated"],[1,"container-fluid","pt-3"],[1,"row","mb-3"],[1,"col-md-6","col-lg-5","col-xl-4"],[1,"d-flex","align-items-center","gap-2",3,"ngSubmit"],["type","text","placeholder","Enter carrier name (e.g. uni_fxfe)","name","carrierName","required","",1,"form-control",2,"max-width","320px",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","d-flex","align-items-center","px-3","ms-2",2,"border-radius","2rem","font-weight","600"],[1,"fas","fa-search","me-1"],[1,"row"],[1,"col-12"],["class","alert alert-warning mb-3",4,"ngIf"],[1,"flex-fill","w-100",2,"min-height","400px"],["class","fusionops-json-viewer",4,"ngIf"],[1,"alert","alert-warning","mb-3"],[1,"fusionops-json-viewer"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0),g("signOut",function(){return i.onSignOut()}),s(1,"div",1)(2,"div",2)(3,"div",3)(4,"form",4),g("ngSubmit",function(){return i.getCarrierProfile()}),s(5,"input",5),I("ngModelChange",function(p){return M(i.carrierName,p)||(i.carrierName=p),p}),a(),s(6,"button",6),b(7,"i",7),s(8,"span"),u(9,"Get"),a()()()()(),s(10,"div",8)(11,"div",9),v(12,nt,2,1,"div",10),s(13,"div",11),v(14,ot,3,1,"pre",12),a()()()()()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(5),P("ngModel",i.carrierName),l(7),d("ngIf",i.carrierProfileError),l(2),d("ngIf",i.carrierProfile))},dependencies:[A,R,j,re,B,U,ne,ae,z,oe,$],encapsulation:2});let n=r;return n})();var rt=n=>({display:n,background:"rgba(0,0,0,0.5)"});function at(n,r){if(n&1){let o=S();s(0,"li")(1,"label",30)(2,"input",31),I("ngModelChange",function(t){let i=f(o).$implicit;return M(i.visible,t)||(i.visible=t),h(t)}),g("change",function(){let t=f(o).$implicit,i=m();return h(i.toggleColumn(t))}),a(),u(3),a()()}if(n&2){let o=r.$implicit;l(2),P("ngModel",o.visible),l(),E(" ",o.label," ")}}function st(n,r){if(n&1){let o=S();s(0,"th",33),g("click",function(t){f(o);let i=m().$implicit,c=m();return h(c.sortBy(i.key,t))}),u(1),b(2,"i",34),a()}if(n&2){let o=m().$implicit;l(),E(" ",o.label," ")}}function lt(n,r){if(n&1&&(O(0),v(1,st,3,1,"th",32),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function ct(n,r){if(n&1&&(s(0,"span"),u(1),fe(2,"date"),a()),n&2){let o=m(3).$implicit;l(),w(he(2,1,o.created,"short"))}}function dt(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(2).$implicit,e=m().$implicit;l(),w(e[o.key])}}function mt(n,r){if(n&1&&(s(0,"td"),O(1,39),v(2,ct,3,4,"span",40)(3,dt,2,1,"span",41),V(),a()),n&2){let o=m().$implicit;l(),d("ngSwitch",o.key),l(),d("ngSwitchCase","created")}}function pt(n,r){if(n&1&&(O(0),v(1,mt,4,2,"td",28),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function ut(n,r){if(n&1){let o=S();s(0,"tr")(1,"td")(2,"input",26),g("change",function(){let t=f(o).$implicit,i=m();return h(i.toggleRowSelection(t.id))}),a()(),v(3,pt,2,1,"ng-container",15),s(4,"td")(5,"button",35),g("click",function(){let t=f(o).$implicit,i=m();return h(i.openEditModal(t))}),b(6,"i",36),a(),s(7,"button",37),g("click",function(){let t=f(o).$implicit,i=m();return h(i.deleteNote(t.id))}),b(8,"i",38),a()()()}if(n&2){let o=r.$implicit,e=m();l(2),d("checked",e.selectedRows.has(o.id)),l(),d("ngForOf",e.columns)}}function gt(n,r){if(n&1&&(s(0,"tr")(1,"td",42),u(2,"No notes found."),a()()),n&2){let o=m();l(),se("colspan",o.getVisibleNotesColspan())}}function _t(n,r){if(n&1){let o=S();s(0,"div",43)(1,"div",44)(2,"div",45)(3,"div",46)(4,"h5",47),u(5),a(),s(6,"button",48),g("click",function(){f(o);let t=m();return h(t.closeModal())}),a()(),s(7,"form",49),g("ngSubmit",function(){f(o);let t=m();return h(t.editingNote?t.updateNoteFromModal():t.addNoteFromModal())}),s(8,"div",50)(9,"div",51)(10,"label",52),u(11,"Title"),a(),s(12,"input",53),I("ngModelChange",function(t){f(o);let i=m();return M(i.modalTitle,t)||(i.modalTitle=t),h(t)}),a()(),s(13,"div",51)(14,"label",52),u(15,"Content"),a(),s(16,"textarea",54),I("ngModelChange",function(t){f(o);let i=m();return M(i.modalContent,t)||(i.modalContent=t),h(t)}),a()()(),s(17,"div",55)(18,"button",56),g("click",function(){f(o);let t=m();return h(t.closeModal())}),u(19,"Cancel"),a(),s(20,"button",57),u(21),a()()()()()()}if(n&2){let o=m();d("ngStyle",ge(5,rt,o.showModal?"block":"none")),l(5),w(o.editingNote?"Edit Note":"Create Note"),l(7),P("ngModel",o.modalTitle),l(4),P("ngModel",o.modalContent),l(5),w(o.editingNote?"Update":"Create")}}var Ke=(()=>{let r=class r{constructor(e,t){this.authService=e,this.router=t,this.notes=[],this.search="",this.sortKeys=[{key:"created",asc:!1}],this.editingNote=null,this.showModal=!1,this.modalTitle="",this.modalContent="",this.columns=[{key:"title",label:"Title",visible:!0},{key:"content",label:"Content",visible:!0},{key:"created",label:"Created",visible:!0}],this.selectedRows=new Set,this.auth$=this.authService.auth$,this.loadNotes()}areAllNotesSelected(){let e=this.getFilteredSortedNotes();return e.length>0&&e.every(t=>this.selectedRows.has(t.id))}getVisibleNotesColspan(){return this.columns.filter(e=>e.visible).length+2}onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}downloadCSV(e=!1){let t=this.columns.filter(y=>y.visible),i=t.map(y=>y.label),c=this.getFilteredSortedNotes(),p=(e?c.filter(y=>this.selectedRows.has(y.id)):c).map(y=>t.map(G=>G.key==="title"||G.key==="content"?'"'+(y[G.key]||"").replace(/"/g,'""')+'"':y[G.key])),_=[i.join(","),...p.map(y=>y.join(","))].join(`\r
`),C=new Blob([_],{type:"text/csv"}),x=window.URL.createObjectURL(C),k=document.createElement("a");k.href=x,k.download="notes.csv",k.click(),window.URL.revokeObjectURL(x)}copySelectedToClipboard(){let e=this.columns.filter(_=>_.visible),t=e.map(_=>_.label),c=this.getFilteredSortedNotes().filter(_=>this.selectedRows.has(_.id)).map(_=>e.map(C=>_[C.key])),p=[t.join("	"),...c.map(_=>_.join("	"))].join(`
`);navigator.clipboard.writeText(p)}toggleColumn(e){e.visible=!e.visible}toggleRowSelection(e){this.selectedRows.has(e)?this.selectedRows.delete(e):this.selectedRows.add(e)}selectAllOnPage(){this.getFilteredSortedNotes().forEach(e=>this.selectedRows.add(e.id))}clearSelection(){this.selectedRows.clear()}sortBy(e,t){let i=e;if(t&&t.shiftKey){let c=this.sortKeys.findIndex(p=>p.key===i);c>-1?this.sortKeys[c].asc=!this.sortKeys[c].asc:this.sortKeys.push({key:i,asc:!0})}else this.sortKeys.length===1&&this.sortKeys[0].key===i?this.sortKeys[0].asc=!this.sortKeys[0].asc:this.sortKeys=[{key:i,asc:!0}];this.sortNotes()}sortNotes(){this.notes.sort((e,t)=>{for(let i of this.sortKeys){let c=e[i.key],p=t[i.key];if(typeof c=="string"&&typeof p=="string"&&(c=c.toLowerCase(),p=p.toLowerCase()),c<p)return i.asc?-1:1;if(c>p)return i.asc?1:-1}return 0})}getFilteredSortedNotes(){let e=this.notes;if(this.search.trim()){let t=this.search.toLowerCase();e=e.filter(i=>i.title.toLowerCase().includes(t)||i.content.toLowerCase().includes(t)||i.created.toLowerCase().includes(t))}return e=[...e],e.sort((t,i)=>{for(let c of this.sortKeys){let p=t[c.key],_=i[c.key];if(typeof p=="string"&&typeof _=="string"&&(p=p.toLowerCase(),_=_.toLowerCase()),p<_)return c.asc?-1:1;if(p>_)return c.asc?1:-1}return 0}),e}loadNotes(){let e=localStorage.getItem("integrationops_notes");this.notes=e?JSON.parse(e):[],this.sortNotes()}saveNotes(){localStorage.setItem("integrationops_notes",JSON.stringify(this.notes)),this.sortNotes()}addNoteFromModal(){if(!this.modalTitle.trim()&&!this.modalContent.trim())return;let e={id:Date.now(),title:this.modalTitle.trim(),content:this.modalContent.trim(),created:new Date().toISOString()};this.notes.push(e),this.saveNotes(),this.closeModal()}openEditModal(e){this.editingNote=F({},e),this.modalTitle=e.title,this.modalContent=e.content,this.showModal=!0}updateNoteFromModal(){if(!this.editingNote)return;let e=this.notes.findIndex(t=>t.id===this.editingNote.id);e>-1&&(this.notes[e]=q(F({},this.editingNote),{title:this.modalTitle.trim(),content:this.modalContent.trim()}),this.saveNotes()),this.closeModal()}closeModal(){this.showModal=!1,this.editingNote=null,this.modalTitle="",this.modalContent=""}deleteNote(e){this.notes=this.notes.filter(t=>t.id!==e),this.saveNotes()}};r.\u0275fac=function(t){return new(t||r)(T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-notes"]],decls:43,vars:10,consts:[[3,"signOut","isAuthenticated"],["header-actions","",1,"btn","btn-gradient-primary","px-4","py-2","rounded-pill",3,"click"],[1,"fas","fa-plus","me-2"],[1,"row","mb-4"],[1,"col-12"],[1,"integrationops-card","integrationops-form","p-4","mb-0","shadow-sm"],[1,"row","g-3","align-items-end"],[1,"col-md-6"],["type","text","placeholder","Search notes...","name","search",1,"form-control",3,"ngModelChange","ngModel"],[1,"row"],[1,"row","mb-2"],[1,"col-md-4","mb-2"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","dropdown-toggle","w-100"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"col-md-8","text-end","mb-2"],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-download","me-2"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-copy","me-2"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],[1,"integrationops-card","p-0","shadow-sm"],[1,"table-responsive"],[1,"table","integrationops-table","align-middle","mb-0"],["type","checkbox",3,"change","checked"],[1,"integrationops-th"],[4,"ngIf"],["class","modal fade show","tabindex","-1",3,"ngStyle",4,"ngIf"],[1,"dropdown-item"],["type","checkbox",3,"ngModelChange","change","ngModel"],["class","integrationops-th","style","cursor:pointer",3,"click",4,"ngIf"],[1,"integrationops-th",2,"cursor","pointer",3,"click"],[1,"fas","fa-sort"],[1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"text-center","text-muted"],["tabindex","-1",1,"modal","fade","show",3,"ngStyle"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","bg-white","text-dark","rounded-4"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],["type","text","name","modalTitle","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","modalContent","rows","3","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer","border-0"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-gradient-primary"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0),g("signOut",function(){return i.onSignOut()}),s(1,"button",1),g("click",function(){return i.showModal=!0}),b(2,"i",2),u(3,"Create Note "),a(),s(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"input",8),I("ngModelChange",function(p){return M(i.search,p)||(i.search=p),p}),a()()()()()(),s(10,"div",9)(11,"div",4)(12,"div",10)(13,"div",11)(14,"div",12)(15,"button",13),u(16," Columns "),a(),s(17,"ul",14),v(18,at,4,2,"li",15),a()()(),s(19,"div",16)(20,"button",17),g("click",function(){return i.downloadCSV(i.selectedRows.size>0)}),b(21,"i",18),u(22,"Download as CSV"),a(),s(23,"button",19),g("click",function(){return i.copySelectedToClipboard()}),b(24,"i",20),u(25,"Copy Selected"),a(),s(26,"button",21),g("click",function(){return i.clearSelection()}),b(27,"i",22),u(28,"Clear Selection"),a()()(),s(29,"div",23)(30,"div",24)(31,"table",25)(32,"thead")(33,"tr")(34,"th")(35,"input",26),g("change",function(p){return p.target.checked?i.selectAllOnPage():i.clearSelection()}),a()(),v(36,lt,2,1,"ng-container",15),s(37,"th",27),u(38,"Actions"),a()()(),s(39,"tbody"),v(40,ut,9,2,"tr",15)(41,gt,3,1,"tr",28),a()()()()()(),v(42,_t,22,7,"div",29),a()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(9),P("ngModel",i.search),l(9),d("ngForOf",i.columns),l(5),d("disabled",i.selectedRows.size===0),l(3),d("disabled",i.selectedRows.size===0),l(9),d("checked",i.areAllNotesSelected()),l(),d("ngForOf",i.columns),l(4),d("ngForOf",i.getFilteredSortedNotes()),l(),d("ngIf",i.getFilteredSortedNotes().length===0),l(),d("ngIf",i.showModal))},dependencies:[j,re,B,ie,U,ne,ae,z,oe,A,X,R,be,Z,ee,te,$,ye],encapsulation:2});let n=r;return n})();var ft=n=>({display:n,background:"rgba(0,0,0,0.5)"});function ht(n,r){if(n&1&&(s(0,"div",26),u(1),a()),n&2){let o=m().$implicit;l(),w(o.description)}}function vt(n,r){if(n&1){let o=S();s(0,"button",22),g("click",function(){f(o);let t=m().$implicit,i=m().index,c=m(2);return h(c.moveTask(t,i,i-1))}),b(1,"i",27),a()}}function bt(n,r){if(n&1){let o=S();s(0,"button",28),g("click",function(){f(o);let t=m().$implicit,i=m().index,c=m(2);return h(c.moveTask(t,i,i+1))}),b(1,"i",29),a()}}function yt(n,r){if(n&1){let o=S();s(0,"div",15),g("dragstart",function(){let t=f(o).$implicit,i=m().index,c=m(2);return h(c.onDragStart(t,i))}),s(1,"div",16)(2,"div",17),u(3),a(),v(4,ht,2,1,"div",18),s(5,"div",19)(6,"div"),v(7,vt,2,0,"button",20)(8,bt,2,0,"button",21),a(),s(9,"button",22),g("click",function(){let t=f(o).$implicit,i=m().index,c=m(2);return h(c.openEditModal(t,i))}),b(10,"i",23),a(),s(11,"button",24),g("click",function(){let t=f(o).$implicit,i=m().index,c=m(2);return h(c.deleteTask(t,i))}),b(12,"i",25),a()()()()}if(n&2){let o=r.$implicit,e=m().index,t=m(2);l(3),w(o.title),l(),d("ngIf",o.description),l(3),d("ngIf",e>0),l(),d("ngIf",e<t.columns.length-1)}}function Ct(n,r){n&1&&(s(0,"div",30),u(1,"No tasks"),a())}function xt(n,r){if(n&1){let o=S();s(0,"div",10)(1,"div",11)(2,"div"),u(3),a(),s(4,"div",12),g("dragover",function(t){f(o);let i=m(2);return h(i.onDragOver(t))})("drop",function(){let t=f(o).index,i=m(2);return h(i.onDrop(t))}),v(5,yt,13,4,"div",13)(6,Ct,2,0,"div",14),a()()()}if(n&2){let o=r.$implicit;l(2),Ee(Pe("card-header ",o.color," fw-semibold text-center")),l(),w(o.name),l(2),d("ngForOf",o.tasks),l(),d("ngIf",o.tasks.length===0)}}function St(n,r){if(n&1&&(s(0,"div")(1,"div",8),v(2,xt,7,6,"div",9),a()()),n&2){let o=m();l(2),d("ngForOf",o.columns)}}function kt(n,r){if(n&1){let o=S();s(0,"li")(1,"label",49)(2,"input",50),I("ngModelChange",function(t){let i=f(o).$implicit;return M(i.visible,t)||(i.visible=t),h(t)}),g("change",function(){let t=f(o).$implicit,i=m(2);return h(i.toggleColumn(t))}),a(),u(3),a()()}if(n&2){let o=r.$implicit;l(2),P("ngModel",o.visible),l(),E(" ",o.label," ")}}function wt(n,r){if(n&1){let o=S();s(0,"th",52),g("click",function(t){f(o);let i=m().$implicit,c=m(2);return h(c.sortBy(i.key,t))}),u(1),b(2,"i",53),a()}if(n&2){let o=m().$implicit;l(),E(" ",o.label," ")}}function Tt(n,r){if(n&1&&(O(0),v(1,wt,3,1,"th",51),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function Et(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(3).$implicit;l(),w(o.column)}}function Pt(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(2).$implicit,e=m().$implicit;l(),w(e[o.key])}}function Mt(n,r){if(n&1&&(s(0,"td"),O(1,5),v(2,Et,2,1,"span",6)(3,Pt,2,1,"span",54),V(),a()),n&2){let o=m().$implicit;l(),d("ngSwitch",o.key),l(),d("ngSwitchCase","column")}}function It(n,r){if(n&1&&(O(0),v(1,Mt,4,2,"td",48),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function Ot(n,r){if(n&1){let o=S();s(0,"tr")(1,"td")(2,"input",47),g("change",function(){let t=f(o).$implicit,i=m(2);return h(i.toggleRowSelection(t.id))}),a()(),v(3,It,2,1,"ng-container",36),a()}if(n&2){let o=r.$implicit,e=m(2);l(2),d("checked",e.selectedRows.has(o.id)),l(),d("ngForOf",e.kanbanColumns)}}function Vt(n,r){if(n&1&&(s(0,"tr")(1,"td",55),u(2,"No tasks found."),a()()),n&2){let o=m(2);l(),se("colspan",o.getVisibleKanbanColspan())}}function Nt(n,r){if(n&1){let o=S();s(0,"div")(1,"div",31)(2,"div",32)(3,"div",33)(4,"button",34),u(5," Columns "),a(),s(6,"ul",35),v(7,kt,4,2,"li",36),a()()(),s(8,"div",37)(9,"button",38),g("click",function(){f(o);let t=m();return h(t.downloadCSV(t.selectedRows.size>0))}),b(10,"i",39),u(11,"Download as CSV"),a(),s(12,"button",40),g("click",function(){f(o);let t=m();return h(t.copySelectedToClipboard())}),b(13,"i",41),u(14,"Copy Selected"),a(),s(15,"button",42),g("click",function(){f(o);let t=m();return h(t.clearSelection())}),b(16,"i",43),u(17,"Clear Selection"),a()()(),s(18,"div",44)(19,"div",45)(20,"table",46)(21,"thead")(22,"tr")(23,"th")(24,"input",47),g("change",function(t){f(o);let i=m();return h(t.target.checked?i.selectAllOnPage():i.clearSelection())}),a()(),v(25,Tt,2,1,"ng-container",36),a()(),s(26,"tbody"),v(27,Ot,4,2,"tr",36)(28,Vt,3,1,"tr",48),a()()()()()}if(n&2){let o=m();l(7),d("ngForOf",o.kanbanColumns),l(5),d("disabled",o.selectedRows.size===0),l(3),d("disabled",o.selectedRows.size===0),l(9),d("checked",o.areAllTasksSelected()),l(),d("ngForOf",o.kanbanColumns),l(2),d("ngForOf",o.getFilteredSortedTasks()),l(),d("ngIf",o.getFilteredSortedTasks().length===0)}}function Dt(n,r){if(n&1){let o=S();s(0,"div",56)(1,"div",57)(2,"div",58)(3,"div",59)(4,"h5",60),u(5),a(),s(6,"button",61),g("click",function(){f(o);let t=m();return h(t.closeModal())}),a()(),s(7,"form",62),g("ngSubmit",function(){f(o);let t=m();return h(t.addOrUpdateTaskFromModal())}),s(8,"div",63)(9,"div",64)(10,"label",65),u(11,"Title"),a(),s(12,"input",66),I("ngModelChange",function(t){f(o);let i=m();return M(i.modalTaskTitle,t)||(i.modalTaskTitle=t),h(t)}),a()(),s(13,"div",64)(14,"label",65),u(15,"Description"),a(),s(16,"textarea",67),I("ngModelChange",function(t){f(o);let i=m();return M(i.modalTaskDescription,t)||(i.modalTaskDescription=t),h(t)}),a()()(),s(17,"div",68)(18,"button",69),g("click",function(){f(o);let t=m();return h(t.closeModal())}),u(19,"Cancel"),a(),s(20,"button",70),u(21),a()()()()()()}if(n&2){let o=m();d("ngStyle",ge(5,ft,o.showModal?"block":"none")),l(5),w(o.editingTask?"Edit Task":"Add Task"),l(7),P("ngModel",o.modalTaskTitle),l(4),P("ngModel",o.modalTaskDescription),l(5),w(o.editingTask?"Update Task":"Add Task")}}var je=(()=>{let r=class r{constructor(e,t){this.authService=e,this.router=t,this.activeTab="board",this.columns=[{name:"To Do",color:"bg-light",tasks:[]},{name:"In Progress",color:"bg-primary text-white",tasks:[]},{name:"Review",color:"bg-warning text-dark",tasks:[]},{name:"Done",color:"bg-success text-white",tasks:[]}],this.dragTask=null,this.dragFromIdx=null,this.showModal=!1,this.modalTaskTitle="",this.modalTaskDescription="",this.editingTask=null,this.editingColIdx=null,this.kanbanColumns=[{key:"title",label:"Title",visible:!0},{key:"description",label:"Description",visible:!0},{key:"column",label:"Column",visible:!0}],this.sortKeys=[{key:"column",asc:!0}],this.selectedRows=new Set,this.auth$=this.authService.auth$,this.loadFromStorage()}onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}areAllTasksSelected(){let e=this.getFilteredSortedTasks();return e.length>0&&e.every(t=>this.selectedRows.has(t.id))}getVisibleKanbanColspan(){return this.kanbanColumns.filter(e=>e.visible).length+1}getAllTasks(){let e=[];return this.columns.forEach((t,i)=>{t.tasks.forEach(c=>e.push(q(F({},c),{column:t.name,colIdx:i})))}),e}getFilteredSortedTasks(){let e=this.getAllTasks();return e=[...e],e.sort((t,i)=>{for(let c of this.sortKeys){let p=t[c.key]||"",_=i[c.key]||"";if(p<_)return c.asc?-1:1;if(p>_)return c.asc?1:-1}return 0}),e}sortBy(e,t){if(t&&t.shiftKey){let i=this.sortKeys.findIndex(c=>c.key===e);i>-1?this.sortKeys[i].asc=!this.sortKeys[i].asc:this.sortKeys.push({key:e,asc:!0})}else this.sortKeys.length===1&&this.sortKeys[0].key===e?this.sortKeys[0].asc=!this.sortKeys[0].asc:this.sortKeys=[{key:e,asc:!0}]}toggleColumn(e){e.visible=!e.visible}toggleRowSelection(e){this.selectedRows.has(e)?this.selectedRows.delete(e):this.selectedRows.add(e)}selectAllOnPage(){this.getFilteredSortedTasks().forEach(e=>this.selectedRows.add(e.id))}clearSelection(){this.selectedRows.clear()}downloadCSV(e=!1){let t=this.kanbanColumns.filter(y=>y.visible),i=t.map(y=>y.label),c=this.getFilteredSortedTasks(),p=(e?c.filter(y=>this.selectedRows.has(y.id)):c).map(y=>t.map(G=>'"'+(y[G.key]||"").replace(/"/g,'""')+'"')),_=[i.join(","),...p.map(y=>y.join(","))].join(`\r
`),C=new Blob([_],{type:"text/csv"}),x=window.URL.createObjectURL(C),k=document.createElement("a");k.href=x,k.download="kanban-tasks.csv",k.click(),window.URL.revokeObjectURL(x)}copySelectedToClipboard(){let e=this.kanbanColumns.filter(_=>_.visible),t=e.map(_=>_.label),c=this.getFilteredSortedTasks().filter(_=>this.selectedRows.has(_.id)).map(_=>e.map(C=>_[C.key])),p=[t.join("	"),...c.map(_=>_.join("	"))].join(`
`);navigator.clipboard.writeText(p)}openAddModal(){this.editingTask=null,this.editingColIdx=null,this.modalTaskTitle="",this.modalTaskDescription="",this.showModal=!0}openEditModal(e,t){this.editingTask=F({},e),this.editingColIdx=t,this.modalTaskTitle=e.title,this.modalTaskDescription=e.description||"",this.showModal=!0}addOrUpdateTaskFromModal(){if(this.modalTaskTitle.trim()){if(this.editingTask&&this.editingColIdx!==null){let e=this.columns[this.editingColIdx],t=e.tasks.findIndex(i=>i.id===this.editingTask.id);t>-1&&(e.tasks[t]=q(F({},e.tasks[t]),{title:this.modalTaskTitle.trim(),description:this.modalTaskDescription.trim()}))}else this.columns[0].tasks.push({id:Date.now(),title:this.modalTaskTitle.trim(),description:this.modalTaskDescription.trim()});this.closeModal(),this.saveToStorage()}}closeModal(){this.showModal=!1,this.modalTaskTitle="",this.modalTaskDescription="",this.editingTask=null,this.editingColIdx=null}moveTask(e,t,i){this.columns[t].tasks=this.columns[t].tasks.filter(c=>c.id!==e.id),this.columns[i].tasks.push(e),this.saveToStorage()}deleteTask(e,t){this.columns[t].tasks=this.columns[t].tasks.filter(i=>i.id!==e.id),this.saveToStorage()}onDragStart(e,t){this.dragTask=e,this.dragFromIdx=t}onDrop(e){this.dragTask!=null&&this.dragFromIdx!=null&&e!==this.dragFromIdx&&this.moveTask(this.dragTask,this.dragFromIdx,e),this.dragTask=null,this.dragFromIdx=null}onDragOver(e){e.preventDefault()}saveToStorage(){localStorage.setItem("integrationops_kanban",JSON.stringify(this.columns))}loadFromStorage(){let e=localStorage.getItem("integrationops_kanban");if(e)try{let t=JSON.parse(e);Array.isArray(t)&&t.length===4&&(this.columns=t)}catch{}}};r.\u0275fac=function(t){return new(t||r)(T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-kanban"]],decls:13,vars:9,consts:[[3,"signOut","isAuthenticated"],[1,"container-fluid","py-5","px-3","px-md-5"],[1,"nav","nav-tabs","mb-3"],[1,"nav-item"],["href","#",1,"nav-link",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","modal fade show","tabindex","-1",3,"ngStyle",4,"ngIf"],[1,"row","kanban-board","g-3"],["class","col-md-3",4,"ngFor","ngForOf"],[1,"col-md-3"],[1,"integrationops-card","h-100"],[1,"card-body","p-2",2,"min-height","200px",3,"dragover","drop"],["class","kanban-task integrationops-card mb-2","draggable","true",3,"dragstart",4,"ngFor","ngForOf"],["class","text-center text-muted small py-3",4,"ngIf"],["draggable","true",1,"kanban-task","integrationops-card","mb-2",3,"dragstart"],[1,"card-body","p-2"],[1,"fw-bold"],["class","text-muted small mb-2",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center"],["class","btn btn-sm btn-outline-primary me-1",3,"click",4,"ngIf"],["class","btn btn-sm btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-primary","me-1",3,"click"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"text-muted","small","mb-2"],[1,"fas","fa-arrow-left"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"fas","fa-arrow-right"],[1,"text-center","text-muted","small","py-3"],[1,"row","mb-2"],[1,"col-md-4","mb-2"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","dropdown-toggle","w-100"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"col-md-8","text-end","mb-2"],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-download","me-2"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-copy","me-2"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],[1,"integrationops-card","p-0","shadow-sm","mb-4"],[1,"table-responsive"],[1,"table","integrationops-table","align-middle","mb-0"],["type","checkbox",3,"change","checked"],[4,"ngIf"],[1,"dropdown-item"],["type","checkbox",3,"ngModelChange","change","ngModel"],["class","fusionops-th","style","cursor:pointer",3,"click",4,"ngIf"],[1,"fusionops-th",2,"cursor","pointer",3,"click"],[1,"fas","fa-sort"],[4,"ngSwitchDefault"],[1,"text-center","text-muted"],["tabindex","-1",1,"modal","fade","show",3,"ngStyle"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content","bg-white","text-dark","rounded-4"],[1,"modal-header","border-0"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[3,"ngSubmit"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],["type","text","name","modalTaskTitle","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","modalTaskDescription","rows","2",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer","border-0"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-gradient-primary"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0),g("signOut",function(){return i.onSignOut()}),s(1,"div",1)(2,"ul",2)(3,"li",3)(4,"a",4),g("click",function(p){return p.preventDefault(),i.activeTab="board"}),u(5,"Board"),a()(),s(6,"li",3)(7,"a",4),g("click",function(p){return p.preventDefault(),i.activeTab="data"}),u(8,"Data"),a()()(),s(9,"div",5),v(10,St,3,1,"div",6)(11,Nt,29,7,"div",6),a(),v(12,Dt,22,7,"div",7),a()()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(4),D("active",i.activeTab==="board"),l(3),D("active",i.activeTab==="data"),l(2),d("ngSwitch",i.activeTab),l(),d("ngSwitchCase","board"),l(),d("ngSwitchCase","data"),l(),d("ngIf",i.showModal))},dependencies:[A,X,R,be,Z,ee,te,j,re,B,ie,U,ne,ae,z,oe,$],styles:[".kanban-board[_ngcontent-%COMP%]{min-height:400px;padding-bottom:2rem}.kanban-task[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #4f8cff1a;background:var(--color-card);transition:var(--transition)}.card-header[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;letter-spacing:.02em;border-bottom:none;background:linear-gradient(90deg,var(--color-bg) 0%,#e0e7ff 100%);color:var(--color-primary)}.card-header.bg-primary[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--color-primary) 0%,var(--color-primary-dark) 100%);color:#fff!important}.card-header.bg-success[_ngcontent-%COMP%]{background:linear-gradient(90deg,#22c55e,#4ade80);color:#fff!important}.card-header.bg-warning[_ngcontent-%COMP%]{background:linear-gradient(90deg,#facc15,#fbbf24);color:#fff!important}.card-header.bg-light[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--color-bg) 0%,#e0e7ff 100%);color:var(--color-primary)!important}.kanban-task[_ngcontent-%COMP%]{border-left:5px solid #6366f1;background:#f8fafc;box-shadow:0 2px 8px #6366f114;margin-bottom:1rem;transition:box-shadow .2s,border-color .2s;cursor:grab}.kanban-task[_ngcontent-%COMP%]:active{cursor:grabbing;box-shadow:0 4px 16px #6366f126;border-color:#3b82f6}.kanban-task[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #6366f126;border-color:#3b82f6}.kanban-task[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem 1rem .75rem}.btn-gradient-primary[_ngcontent-%COMP%]{background:linear-gradient(90deg,#6366f1,#3b82f6);color:#fff;border:none;font-weight:600;border-radius:0;box-shadow:0 2px 8px #6366f11a;transition:background .2s,color .2s}.btn-gradient-primary[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#3b82f6,#6366f1);color:#fff}.kanban-task[_ngcontent-%COMP%]   .fw-bold[_ngcontent-%COMP%]{font-size:1.05rem;color:#3b3f5c}.kanban-task[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{color:#94a3b8!important}.kanban-task[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:0}.kanban-task[_ngcontent-%COMP%]   .btn-outline-primary[_ngcontent-%COMP%]{border-color:#6366f1;color:#6366f1}.kanban-task[_ngcontent-%COMP%]   .btn-outline-primary[_ngcontent-%COMP%]:hover{background:#6366f1;color:#fff}.kanban-task[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]{border-color:#ef4444;color:#ef4444}.kanban-task[_ngcontent-%COMP%]   .btn-outline-danger[_ngcontent-%COMP%]:hover{background:#ef4444;color:#fff}.kanban-task[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{margin-top:.5rem}.text-center.text-muted.small.py-3[_ngcontent-%COMP%]{background:#f1f5f9;border-radius:0}"]});let n=r;return n})();function At(n,r){n&1&&(s(0,"span",42),u(1,"Saved!"),a())}function Ft(n,r){n&1&&(s(0,"span",42),u(1,"Saved!"),a())}function Rt(n,r){if(n&1){let o=S();s(0,"li")(1,"label",43)(2,"input",44),I("ngModelChange",function(t){let i=f(o).$implicit;return M(i.visible,t)||(i.visible=t),h(t)}),g("change",function(){let t=f(o).$implicit,i=m();return h(i.toggleColumn(t))}),a(),u(3),a()()}if(n&2){let o=r.$implicit;l(2),P("ngModel",o.visible),l(),E(" ",o.label," ")}}function Lt(n,r){if(n&1){let o=S();s(0,"th",46),g("click",function(t){f(o);let i=m().$implicit,c=m();return h(c.sortBy(i.key,t))}),u(1),b(2,"i",47),a()}if(n&2){let o=m().$implicit;l(),E(" ",o.label," ")}}function Kt(n,r){if(n&1&&(O(0),v(1,Lt,3,1,"th",45),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function jt(n,r){if(n&1&&(s(0,"span")(1,"pre",53),u(2),a()()),n&2){let o=m(3).$implicit;l(2),w(o.value)}}function $t(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(2).$implicit,e=m().$implicit;l(),w(e[o.key])}}function Wt(n,r){if(n&1&&(s(0,"td"),O(1,50),v(2,jt,3,1,"span",51)(3,$t,2,1,"span",52),V(),a()),n&2){let o=m().$implicit;l(),d("ngSwitch",o.key),l(),d("ngSwitchCase","value")}}function Bt(n,r){if(n&1&&(O(0),v(1,Wt,4,2,"td",40),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function Ut(n,r){if(n&1){let o=S();s(0,"tr")(1,"td")(2,"input",38),g("change",function(){let t=f(o).$implicit,i=m();return h(i.toggleRowSelection(t.key))}),a()(),v(3,Bt,2,1,"ng-container",27),s(4,"td")(5,"button",48),g("click",function(){let t=f(o).$implicit,i=m();return h(i.deleteKey(t.key))}),b(6,"i",49),a()()()}if(n&2){let o=r.$implicit,e=m();l(2),d("checked",e.selectedRows.has(o.key)),l(),d("ngForOf",e.columns)}}function zt(n,r){if(n&1&&(s(0,"tr")(1,"td",54),u(2,"No storage items found."),a()()),n&2){let o=m();l(),se("colspan",o.getVisibleStorageColspan())}}function Jt(n,r){n&1&&(s(0,"div",55),u(1,"No IntegrationOps storage found."),a())}var $e=(()=>{let r=class r{constructor(e,t){this.authService=e,this.activeTab="secrets",this.apiId="",this.secret="",this.saved=!1,this.pagerDutyToken="",this.pagerDutySaved=!1,this.fusionopsStorage=[],this.sortKeys=[{key:"key",asc:!0}],this.columns=[{key:"key",label:"Key",visible:!0},{key:"value",label:"Value",visible:!0}],this.selectedRows=new Set,this.auth$=this.authService.auth$,this.router=t}areAllStorageSelected(){let e=this.getFilteredSortedStorage();return e.length>0&&e.every(t=>this.selectedRows.has(t.key))}getVisibleStorageColspan(){return this.columns.filter(e=>e.visible).length+2}onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}ngOnInit(){this.loadSecrets(),this.loadFusionopsStorage()}loadSecrets(){let e=localStorage.getItem("integrationops_secrets");if(e)try{let t=atob(e),{apiId:i,secret:c,pagerDutyToken:p}=JSON.parse(t);this.apiId=i,this.secret=c,this.pagerDutyToken=p||""}catch{}}savePagerDutyToken(){let e=localStorage.getItem("integrationops_secrets"),t={apiId:"",secret:"",pagerDutyToken:this.pagerDutyToken};if(e)try{let c=atob(e);t=q(F(F({},t),JSON.parse(c)),{pagerDutyToken:this.pagerDutyToken})}catch{}let i=btoa(JSON.stringify(t));localStorage.setItem("integrationops_secrets",i),this.pagerDutySaved=!0,setTimeout(()=>this.pagerDutySaved=!1,2e3)}loadFusionopsStorage(){this.fusionopsStorage=[];for(let e=0;e<localStorage.length;e++){let t=localStorage.key(e);if(t.startsWith("integrationops_")){let i=localStorage.getItem(t)??"";this.fusionopsStorage.push({key:t,value:i})}}this.sortStorage()}setTab(e){this.activeTab=e,e==="storage"&&this.loadFusionopsStorage()}saveSecrets(){let e={apiId:this.apiId,secret:this.secret,pagerDutyToken:this.pagerDutyToken},t=btoa(JSON.stringify(e));localStorage.setItem("integrationops_secrets",t),this.saved=!0,setTimeout(()=>this.saved=!1,2e3),this.loadFusionopsStorage()}deleteKey(e){confirm(`Are you sure you want to delete the key "${e}"?`)&&(localStorage.removeItem(e),this.loadFusionopsStorage())}sortBy(e,t){let i=e;if(t&&t.shiftKey){let c=this.sortKeys.findIndex(p=>p.key===i);c>-1?this.sortKeys[c].asc=!this.sortKeys[c].asc:this.sortKeys.push({key:i,asc:!0})}else this.sortKeys.length===1&&this.sortKeys[0].key===i?this.sortKeys[0].asc=!this.sortKeys[0].asc:this.sortKeys=[{key:i,asc:!0}];this.sortStorage()}sortStorage(){this.fusionopsStorage.sort((e,t)=>{for(let i of this.sortKeys){let c=e[i.key]||"",p=t[i.key]||"";if(c<p)return i.asc?-1:1;if(c>p)return i.asc?1:-1}return 0})}toggleColumn(e){e.visible=!e.visible}toggleRowSelection(e){this.selectedRows.has(e)?this.selectedRows.delete(e):this.selectedRows.add(e)}selectAllOnPage(){this.getFilteredSortedStorage().forEach(e=>this.selectedRows.add(e.key))}clearSelection(){this.selectedRows.clear()}getFilteredSortedStorage(){let e=this.fusionopsStorage;return e=[...e],e.sort((t,i)=>{for(let c of this.sortKeys){let p=t[c.key]||"",_=i[c.key]||"";if(p<_)return c.asc?-1:1;if(p>_)return c.asc?1:-1}return 0}),e}downloadStorageCSV(e=!1){let t=this.columns.filter(y=>y.visible),i=t.map(y=>y.label),c=this.getFilteredSortedStorage(),p=(e?c.filter(y=>this.selectedRows.has(y.key)):c).map(y=>t.map(G=>'"'+(y[G.key]||"").replace(/"/g,'""')+'"')),_=[i.join(","),...p.map(y=>y.join(","))].join(`\r
`),C=new Blob([_],{type:"text/csv"}),x=window.URL.createObjectURL(C),k=document.createElement("a");k.href=x,k.download="integrationops-storage.csv",k.click(),window.URL.revokeObjectURL(x)}copySelectedToClipboard(){let e=this.columns.filter(_=>_.visible),t=e.map(_=>_.label),c=this.getFilteredSortedStorage().filter(_=>this.selectedRows.has(_.key)).map(_=>e.map(C=>_[C.key])),p=[t.join("	"),...c.map(_=>_.join("	"))].join(`
`);navigator.clipboard.writeText(p)}};r.\u0275fac=function(t){return new(t||r)(T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-settings"]],decls:76,vars:26,consts:[[3,"signOut","isAuthenticated"],[1,"container-fluid","py-5","px-3","px-md-5"],[1,"mb-4"],[1,"nav","nav-tabs","mb-3"],[1,"nav-item"],["href","#",1,"nav-link",3,"click"],[1,"tab-content"],[1,"tab-pane"],["autocomplete","off",1,"row","g-3",3,"ngSubmit"],[1,"col-md-6","col-lg-4"],["for","apiId",1,"form-label"],["id","apiId","type","text","name","apiId","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","secret",1,"form-label"],["id","secret","type","password","name","secret","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","align-self-end"],["type","submit",1,"btn","btn-primary"],["class","text-success ms-3",4,"ngIf"],["for","pagerDutyToken",1,"form-label"],["id","pagerDutyToken","type","password","name","pagerDutyToken","placeholder","Enter PagerDuty API token",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],[1,"card","mb-4"],[1,"card-body"],[1,"row","mb-2"],[1,"col-md-4","mb-2"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","dropdown-toggle","w-100"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"col-md-8","text-end","mb-2"],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-download","me-2"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-copy","me-2"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],[1,"table-responsive","mt-3"],[1,"table","table-hover","table-bordered","align-middle","notes-table"],[1,"table-light"],["type","checkbox",3,"change","checked"],[2,"width","5%"],[4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-success","ms-3"],[1,"dropdown-item"],["type","checkbox",3,"ngModelChange","change","ngModel"],["style","cursor:pointer",3,"click",4,"ngIf"],[2,"cursor","pointer",3,"click"],[1,"fas","fa-sort"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mb-0","text-break"],[1,"text-center","text-muted"],[1,"text-muted"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0),g("signOut",function(){return i.onSignOut()}),s(1,"div",1)(2,"h2",2),u(3,"Settings"),a(),s(4,"ul",3)(5,"li",4)(6,"a",5),g("click",function(p){return p.preventDefault(),i.setTab("secrets")}),u(7,"Secrets"),a()(),s(8,"li",4)(9,"a",5),g("click",function(p){return p.preventDefault(),i.setTab("storage")}),u(10,"Storage"),a()(),s(11,"li",4)(12,"a",5),g("click",function(p){return p.preventDefault(),i.setTab("pagerduty")}),u(13,"PagerDuty"),a()()(),s(14,"div",6)(15,"div",7)(16,"form",8),g("ngSubmit",function(){return i.saveSecrets()}),s(17,"div",9)(18,"label",10),u(19,"API ID"),a(),s(20,"input",11),I("ngModelChange",function(p){return M(i.apiId,p)||(i.apiId=p),p}),a()(),s(21,"div",9)(22,"label",12),u(23,"Secret"),a(),s(24,"input",13),I("ngModelChange",function(p){return M(i.secret,p)||(i.secret=p),p}),a()(),s(25,"div",14)(26,"button",15),u(27,"Save"),a(),v(28,At,2,0,"span",16),a()()(),s(29,"div",7)(30,"form",8),g("ngSubmit",function(){return i.savePagerDutyToken()}),s(31,"div",9)(32,"label",17),u(33,"PagerDuty API Token"),a(),s(34,"input",18),I("ngModelChange",function(p){return M(i.pagerDutyToken,p)||(i.pagerDutyToken=p),p}),a(),s(35,"div",19),u(36,"Stored securely and used for PagerDuty integration."),a()(),s(37,"div",14)(38,"button",15),u(39,"Update PagerDuty Token"),a(),v(40,Ft,2,0,"span",16),a()()(),s(41,"div",7)(42,"div",20)(43,"div",21)(44,"h5"),u(45,"IntegrationOps Storage"),a(),s(46,"div",22)(47,"div",23)(48,"div",24)(49,"button",25),u(50," Columns "),a(),s(51,"ul",26),v(52,Rt,4,2,"li",27),a()()(),s(53,"div",28)(54,"button",29),g("click",function(){return i.downloadStorageCSV(i.selectedRows.size>0)}),b(55,"i",30),u(56,"Download as CSV"),a(),s(57,"button",31),g("click",function(){return i.copySelectedToClipboard()}),b(58,"i",32),u(59,"Copy Selected"),a(),s(60,"button",33),g("click",function(){return i.clearSelection()}),b(61,"i",34),u(62,"Clear Selection"),a()()(),s(63,"div",35)(64,"table",36)(65,"thead",37)(66,"tr")(67,"th")(68,"input",38),g("change",function(p){return p.target.checked?i.selectAllOnPage():i.clearSelection()}),a()(),v(69,Kt,2,1,"ng-container",27),s(70,"th",39),u(71,"Delete"),a()()(),s(72,"tbody"),v(73,Ut,7,2,"tr",27)(74,zt,3,1,"tr",40),a()()(),v(75,Jt,2,0,"div",41),a()()()()()()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(6),D("active",i.activeTab==="secrets"),l(3),D("active",i.activeTab==="storage"),l(3),D("active",i.activeTab==="pagerduty"),l(3),D("active",i.activeTab==="secrets"),l(5),P("ngModel",i.apiId),l(4),P("ngModel",i.secret),l(4),d("ngIf",i.saved),l(),D("active",i.activeTab==="pagerduty"),l(5),P("ngModel",i.pagerDutyToken),l(6),d("ngIf",i.pagerDutySaved),l(),D("active",i.activeTab==="storage"),l(11),d("ngForOf",i.columns),l(5),d("disabled",i.selectedRows.size===0),l(3),d("disabled",i.selectedRows.size===0),l(8),d("checked",i.areAllStorageSelected()),l(),d("ngForOf",i.columns),l(4),d("ngForOf",i.getFilteredSortedStorage()),l(),d("ngIf",i.getFilteredSortedStorage().length===0),l(),d("ngIf",i.getFilteredSortedStorage().length===0))},dependencies:[A,X,R,Z,ee,te,j,re,B,ie,U,ne,ae,z,oe,$],styles:[".notes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .notes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.notes-table[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{background:none;border:none;margin:0;padding:0;font-family:inherit;font-size:inherit;white-space:pre-wrap;word-break:break-all}.text-success[_ngcontent-%COMP%]{font-weight:700}"]});let n=r;return n})();var We=(()=>{let r=class r{constructor(e){this.http=e}getEvents(e){let t=new Me({Authorization:`Token token=${e}`,Accept:"application/vnd.pagerduty+json;version=2"});return this.http.get("/pagerduty/incidents",{headers:t})}};r.\u0275fac=function(t){return new(t||r)(Q(le))},r.\u0275prov=Y({token:r,factory:r.\u0275fac,providedIn:"root"});let n=r;return n})();var Ht=()=>[];function Gt(n,r){n&1&&(s(0,"div",8),u(1,"Loading PagerDuty events..."),a())}function Yt(n,r){if(n&1&&(s(0,"div",9),u(1),a()),n&2){let o=m();l(),w(o.error)}}function Qt(n,r){if(n&1){let o=S();s(0,"li")(1,"label",24)(2,"input",25),I("ngModelChange",function(t){let i=f(o).$implicit;return M(i.visible,t)||(i.visible=t),h(t)}),g("change",function(){let t=f(o).$implicit,i=m(2);return h(i.toggleColumn(t))}),a(),u(3),a()()}if(n&2){let o=r.$implicit;l(2),P("ngModel",o.visible),l(),E(" ",o.label," ")}}function Xt(n,r){if(n&1){let o=S();s(0,"div",10)(1,"div",11)(2,"input",12),I("ngModelChange",function(t){f(o);let i=m();return M(i.search,t)||(i.search=t),h(t)}),g("ngModelChange",function(){f(o);let t=m();return h(t.onSearchChange())}),a()(),s(3,"div",11)(4,"div",13)(5,"button",14),u(6," Columns "),a(),s(7,"ul",15),v(8,Qt,4,2,"li",16),a()()(),s(9,"div",17)(10,"button",18),g("click",function(){f(o);let t=m();return h(t.downloadCSV(t.selectedRows.size>0))}),b(11,"i",19),u(12,"Download as CSV"),a(),s(13,"button",20),g("click",function(){f(o);let t=m();return h(t.copySelectedToClipboard())}),b(14,"i",21),u(15,"Copy Selected"),a(),s(16,"button",22),g("click",function(){f(o);let t=m();return h(t.clearSelection())}),b(17,"i",23),u(18,"Clear Selection"),a()()()}if(n&2){let o=m();l(2),P("ngModel",o.search),l(6),d("ngForOf",o.columns),l(5),d("disabled",o.selectedRows.size===0),l(3),d("disabled",o.selectedRows.size===0)}}function Zt(n,r){n&1&&(s(0,"div",26),u(1,"No PagerDuty events found."),a())}function ei(n,r){if(n&1){let o=S();s(0,"th",33),g("click",function(t){f(o);let i=m().$implicit,c=m(2);return h(c.sortBy(i.key,t))}),u(1),b(2,"i",34),a()}if(n&2){let o=m().$implicit;l(),E(" ",o.label," ")}}function ti(n,r){if(n&1&&(O(0),v(1,ei,3,1,"th",32),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function ii(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(3).$implicit;l(),w(o.service==null?null:o.service.summary)}}function ni(n,r){if(n&1&&(s(0,"span"),u(1),fe(2,"date"),a()),n&2){let o=m(3).$implicit;l(),w(he(2,1,o.created_at,"short"))}}function oi(n,r){if(n&1&&(s(0,"span"),u(1),a()),n&2){let o=m(2).$implicit,e=m().$implicit;l(),w(e[o.key])}}function ri(n,r){if(n&1&&(s(0,"td"),O(1,36),v(2,ii,2,1,"span",37)(3,ni,3,4,"span",37)(4,oi,2,1,"span",38),V(),a()),n&2){let o=m().$implicit;l(),d("ngSwitch",o.key),l(),d("ngSwitchCase","service"),l(),d("ngSwitchCase","created_at")}}function ai(n,r){if(n&1&&(O(0),v(1,ri,5,3,"td",35),V()),n&2){let o=r.$implicit;l(),d("ngIf",o.visible)}}function si(n,r){if(n&1){let o=S();s(0,"tr")(1,"td")(2,"input",30),g("change",function(){let t=f(o).$implicit,i=m(2);return h(i.toggleRowSelection(t.id))}),a()(),v(3,ai,2,1,"ng-container",16),a()}if(n&2){let o=r.$implicit,e=m(2);l(2),d("checked",e.selectedRows.has(o.id)),l(),d("ngForOf",e.columns)}}function li(n,r){if(n&1){let o=S();s(0,"li",41)(1,"a",42),g("click",function(t){let i=f(o).index,c=m(3);return t.preventDefault(),h(c.setPage(i+1))}),u(2),a()()}if(n&2){let o=r.index,e=m(3);D("active",e.page===o+1),l(2),w(o+1)}}function ci(n,r){if(n&1){let o=S();s(0,"nav",39)(1,"ul",40)(2,"li",41)(3,"a",42),g("click",function(t){f(o);let i=m(2);return t.preventDefault(),h(i.setPage(i.page-1))}),u(4,"\xAB"),a()(),v(5,li,3,3,"li",43),s(6,"li",41)(7,"a",42),g("click",function(t){f(o);let i=m(2);return t.preventDefault(),h(i.setPage(i.page+1))}),u(8,"\xBB"),a()()()()}if(n&2){let o=m(2);l(2),D("disabled",o.page===1),l(3),d("ngForOf",H(5,Ht).constructor(o.totalPages)),l(),D("disabled",o.page===o.totalPages)}}function di(n,r){if(n&1){let o=S();s(0,"div",27)(1,"table",28)(2,"thead",29)(3,"tr")(4,"th")(5,"input",30),g("change",function(t){f(o);let i=m();return h(t.target.checked?i.selectAllOnPage():i.clearSelection())}),a()(),v(6,ti,2,1,"ng-container",16),a()(),s(7,"tbody"),v(8,si,4,2,"tr",16),a()(),v(9,ci,9,6,"nav",31),a()}if(n&2){let o=m();l(5),d("checked",o.areAllRowsSelectedOnPage()),l(),d("ngForOf",o.columns),l(2),d("ngForOf",o.pagedEvents),l(),d("ngIf",o.totalPages>1)}}var Be=(()=>{let r=class r{areAllRowsSelectedOnPage(){return this.pagedEvents.length>0&&this.pagedEvents.every(e=>this.selectedRows.has(e.id))}constructor(e,t,i){this.pagerDuty=e,this.authService=t,this.router=i,this.events=[],this.filteredEvents=[],this.loading=!1,this.error="",this.search="",this.sortKeys=[{key:"created_at",asc:!1}],this.page=1,this.pageSize=10,this.columns=[{key:"id",label:"ID",visible:!0},{key:"title",label:"Title",visible:!0},{key:"status",label:"Status",visible:!0},{key:"urgency",label:"Urgency",visible:!0},{key:"created_at",label:"Created At",visible:!0},{key:"service",label:"Service",visible:!0}],this.selectedRows=new Set,this.auth$=this.authService.auth$}onSignOut(){this.authService.signOut(),this.router.navigate(["/"])}ngOnInit(){this.loadColumnPrefs(),this.loadEvents()}loadColumnPrefs(){let e=localStorage.getItem("pagerduty_events_columns");if(e)try{let t=JSON.parse(e);Array.isArray(t)&&(this.columns=this.columns.map(i=>{let c=t.find(p=>p.key===i.key);return c?q(F({},i),{visible:c.visible}):i}))}catch{}}saveColumnPrefs(){localStorage.setItem("pagerduty_events_columns",JSON.stringify(this.columns))}loadEvents(){this.loading=!0,this.error="";let e=localStorage.getItem("integrationops_secrets"),t="";if(e)try{let i=atob(e),{pagerDutyToken:c}=JSON.parse(i);t=c||""}catch{}if(!t){this.error="PagerDuty API token not found. Please add it in Settings.",this.loading=!1;return}this.pagerDuty.getEvents(t).subscribe({next:i=>{this.events=(i.incidents||[]).filter(c=>{let p=c.service?.summary?.toLowerCase()||"";return p==="Ipaas-24x7"||p==="Ipaas"}),this.applyFilters(),this.loading=!1},error:i=>{this.loading=!1,this.error="Failed to load PagerDuty events"}})}applyFilters(){let e=this.events;if(this.search.trim()){let t=this.search.toLowerCase();e=e.filter(i=>(i.title||"").toLowerCase().includes(t)||(i.status||"").toLowerCase().includes(t)||(i.urgency||"").toLowerCase().includes(t)||(i.service?.summary||"").toLowerCase().includes(t))}e=e.sort((t,i)=>{for(let c of this.sortKeys){let p=c.key==="service"?t.service?.summary||"":t[c.key]||"",_=c.key==="service"?i.service?.summary||"":i[c.key]||"";if(typeof p=="string"&&(p=p.toLowerCase()),typeof _=="string"&&(_=_.toLowerCase()),p<_)return c.asc?-1:1;if(p>_)return c.asc?1:-1}return 0}),this.filteredEvents=e,this.page=1,this.selectedRows.clear()}onSearchChange(){this.applyFilters()}sortBy(e,t){if(t&&t.shiftKey){let i=this.sortKeys.findIndex(c=>c.key===e);i>-1?this.sortKeys[i].asc=!this.sortKeys[i].asc:this.sortKeys.push({key:e,asc:!0})}else this.sortKeys.length===1&&this.sortKeys[0].key===e?this.sortKeys[0].asc=!this.sortKeys[0].asc:this.sortKeys=[{key:e,asc:!0}];this.applyFilters()}toggleColumn(e){e.visible=!e.visible,this.saveColumnPrefs()}get pagedEvents(){let e=(this.page-1)*this.pageSize;return this.filteredEvents.slice(e,e+this.pageSize)}get totalPages(){return Math.ceil(this.filteredEvents.length/this.pageSize)||1}setPage(e){e<1||e>this.totalPages||(this.page=e)}toggleRowSelection(e){this.selectedRows.has(e)?this.selectedRows.delete(e):this.selectedRows.add(e)}selectAllOnPage(){this.pagedEvents.forEach(e=>this.selectedRows.add(e.id))}clearSelection(){this.selectedRows.clear()}downloadCSV(e=!1){let t=this.columns.filter(k=>k.visible),i=t.map(k=>k.label),c=(e?this.filteredEvents.filter(k=>this.selectedRows.has(k.id)):this.filteredEvents).map(k=>t.map(y=>y.key==="service"?'"'+(k.service?.summary||"").replace(/"/g,'""')+'"':y.key==="title"?'"'+(k.title||"").replace(/"/g,'""')+'"':k[y.key])),p=[i.join(","),...c.map(k=>k.join(","))].join(`\r
`),_=new Blob([p],{type:"text/csv"}),C=window.URL.createObjectURL(_),x=document.createElement("a");x.href=C,x.download="pagerduty-events.csv",x.click(),window.URL.revokeObjectURL(C)}copySelectedToClipboard(){let e=this.columns.filter(p=>p.visible),t=e.map(p=>p.label),i=this.filteredEvents.filter(p=>this.selectedRows.has(p.id)).map(p=>e.map(_=>_.key==="service"?p.service?.summary||"":_.key==="title"?p.title||"":p[_.key])),c=[t.join("	"),...i.map(p=>p.join("	"))].join(`
`);navigator.clipboard.writeText(c)}};r.\u0275fac=function(t){return new(t||r)(T(We),T(K),T(L))},r.\u0275cmp=N({type:r,selectors:[["app-pagerduty-events"]],decls:9,vars:6,consts:[[3,"isAuthenticated"],[1,"container-fluid","px-0"],[1,"mb-4"],["class","alert alert-info",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","row mb-3",4,"ngIf"],["class","alert alert-warning",4,"ngIf"],["class","table-responsive mt-3",4,"ngIf"],[1,"alert","alert-info"],[1,"alert","alert-danger"],[1,"row","mb-3"],[1,"col-md-4","mb-2"],["type","text","placeholder","Search events...",1,"form-control",3,"ngModelChange","ngModel"],[1,"dropdown"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","dropdown-toggle","w-100"],[1,"dropdown-menu"],[4,"ngFor","ngForOf"],[1,"col-md-4","text-end","mb-2"],[1,"btn","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-download","me-2"],[1,"btn","btn-outline-secondary","me-2",3,"click","disabled"],[1,"fas","fa-copy","me-2"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],[1,"dropdown-item"],["type","checkbox",3,"ngModelChange","change","ngModel"],[1,"alert","alert-warning"],[1,"table-responsive","mt-3"],[1,"table","table-hover","table-bordered","align-middle"],[1,"table-light"],["type","checkbox",3,"change","checked"],["class","mt-3",4,"ngIf"],["style","cursor:pointer",3,"click",4,"ngIf"],[2,"cursor","pointer",3,"click"],[1,"fas","fa-sort"],[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"mt-3"],[1,"pagination","justify-content-center"],[1,"page-item"],["href","#",1,"page-link",3,"click"],["class","page-item",3,"active",4,"ngFor","ngForOf"]],template:function(t,i){t&1&&(s(0,"integrationops-private-layout",0)(1,"div",1)(2,"h2",2),u(3,"PagerDuty Events"),a(),v(4,Gt,2,0,"div",3)(5,Yt,2,1,"div",4)(6,Xt,19,4,"div",5)(7,Zt,2,0,"div",6)(8,di,10,4,"div",7),a()()),t&2&&(d("isAuthenticated",i.authService.isAuthenticated),l(4),d("ngIf",i.loading),l(),d("ngIf",i.error),l(),d("ngIf",!i.loading&&!i.error),l(),d("ngIf",!i.loading&&!i.error&&i.filteredEvents.length===0),l(),d("ngIf",i.filteredEvents.length>0))},dependencies:[A,X,R,Z,ee,te,j,B,ie,U,z,$,ye],encapsulation:2});let n=r;return n})();var on=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:Fe},{path:"carrier-profile",component:Le},{path:"notes",component:Ke},{path:"kanban",component:je},{path:"settings",component:$e},{path:"pagerduty-events",component:Be}];export{on as PRIVATE_ROUTES};
